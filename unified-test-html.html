<!DOCTYPE html>
<html>
<head>
  <title>Unified Search - AddictionTube</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    input, select, button { padding: 8px; margin: 5px 0; }
    #results { margin-top: 20px; }
    .result { padding: 10px; border: 1px solid #ccc; margin-bottom: 10px; }
  </style>
</head>
<body>
  <h1>Unified Search</h1>

  <label>Search Term:</label><br>
  <input type="text" id="query" placeholder="Enter search term" size="40"><br>

  <label>Category:</label><br>
  <select id="category">
    <option value="song">üéµ Song</option>
    <option value="poem">üìù Poem</option>
    <option value="story">üìñ Story</option>
  </select><br>

  <button onclick="runSearch()">Search</button>
  <button onclick="getRagAnswer()">Ask AI</button>

  <div id="results"></div>

  <script>
    async function runSearch() {
      const q = document.getElementById('query').value;
      const category = document.getElementById('category').value;
      const res = await fetch(`search.php?q=${encodeURIComponent(q)}&category=${category}`);
      const data = await res.json();

      const container = document.getElementById('results');
      container.innerHTML = `<h2>${data.results?.length || 0} Results</h2>`;
      data.results?.forEach(r => {
        container.innerHTML += `<div class="result"><strong>${r.title}</strong><br>${r.description}</div>`;
      });
    }

    async function getRagAnswer() {
      const q = document.getElementById('query').value;
      const category = document.getElementById('category').value;
      const res = await fetch(`rag-answer.php?q=${encodeURIComponent(q)}&category=${category}`);
      const data = await res.json();

      const container = document.getElementById('results');
      container.innerHTML = `<h2>AI Answer</h2><p>${data.answer || data.error}</p>`;
    }
  </script>
</body>
</html>
